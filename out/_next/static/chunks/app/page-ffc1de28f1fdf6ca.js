(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5678:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var o=r(5155);r(9137);var a=r(2115),n=r(1154),s=r(3999),c=r(5631),i=r(9304),l=r(2402),d=r(1828),h=r(581);class u{static getInstance(){return u.instance||(u.instance=new u),u.instance}isGeolocationSupported(){return"geolocation"in navigator}async getPermissionStatus(){if(!this.isGeolocationSupported())return{granted:!1,denied:!1,prompt:!1,supported:!1};try{if("permissions"in navigator){let e=await navigator.permissions.query({name:"geolocation"});return{granted:"granted"===e.state,denied:"denied"===e.state,prompt:"prompt"===e.state,supported:!0}}}catch(e){console.warn("Permissions API not available:",e)}return{granted:!1,denied:!1,prompt:!0,supported:!0}}async getCurrentLocation(e){let t={enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5,useCache:!0,...e};if(t.useCache&&this.currentPosition&&Date.now()-this.lastRequestTime<this.CACHE_DURATION)return console.log("Returning cached location:",this.currentPosition),this.currentPosition;if(!this.isGeolocationSupported())throw this.createLocationError("NOT_SUPPORTED","Geolocation is not supported by this browser");try{console.log("Requesting geolocation with options:",t);let e=await new Promise((e,r)=>{navigator.geolocation.getCurrentPosition(e,r,{enableHighAccuracy:t.enableHighAccuracy,timeout:t.timeout,maximumAge:t.maximumAge})});console.log("Geolocation success:",e);let r=await this.reverseGeocode(e.coords.latitude,e.coords.longitude);return this.currentPosition={...r,source:"geolocation"},this.lastRequestTime=Date.now(),this.currentPosition}catch(e){throw console.error("Geolocation error:",e),this.handleGeolocationError(e)}}async getLocationByIP(){console.log("Attempting IP-based location detection...");try{for(let e of["https://ipapi.co/json/","https://ipinfo.io/json","https://api.ipgeolocation.io/ipgeo?apiKey=free"])try{console.log("Trying IP service: ".concat(e));let t=await fetch(e);if(!t.ok){console.warn("IP service failed: ".concat(e," - ").concat(t.status));continue}let r=await t.json();console.log("IP service response from ".concat(e,":"),r);let o=this.parseIPLocationResponse(r,e);if(o)return console.log("IP-based location detected:",o),{...o,source:"ip"}}catch(t){console.warn("IP service error for ".concat(e,":"),t);continue}throw this.createLocationError("NETWORK_ERROR","All IP-based location services failed")}catch(e){throw console.error("IP location detection failed:",e),e}}async reverseGeocode(e,t){try{let r=await fetch("https://nominatim.openstreetmap.org/reverse?lat=".concat(e,"&lon=").concat(t,"&format=json&accept-language=en"));if(!r.ok)throw Error("Reverse geocoding failed: ".concat(r.status));let o=await r.json();console.log("Reverse geocoding response:",o);let a=o.address||{},n=a.city||a.town||a.village||a.hamlet||"Unknown City",s=a.state||a.province||a.region||"",c=a.country||"Unknown Country";return{latitude:e,longitude:t,city:n,region:s,country:c,displayName:s?"".concat(n,", ").concat(s,", ").concat(c):"".concat(n,", ").concat(c),source:"geolocation"}}catch(r){return console.warn("Reverse geocoding failed, using coordinates:",r),{latitude:e,longitude:t,displayName:"".concat(e.toFixed(4),", ").concat(t.toFixed(4)),source:"geolocation"}}}parseIPLocationResponse(e,t){try{let r,o,a,n,s;if(t.includes("ipapi.co"))r=parseFloat(e.latitude),o=parseFloat(e.longitude),a=e.city||"Unknown City",n=e.region||"",s=e.country_name||e.country||"Unknown Country";else if(t.includes("ipinfo.io")){let[t,c]=(e.loc||"0,0").split(",").map(parseFloat);r=t,o=c,a=e.city||"Unknown City",n=e.region||"",s=e.country||"Unknown Country"}else{if(!t.includes("ipgeolocation.io"))return null;r=parseFloat(e.latitude),o=parseFloat(e.longitude),a=e.city||"Unknown City",n=e.state_prov||"",s=e.country_name||"Unknown Country"}if(isNaN(r)||isNaN(o))return console.warn("Invalid coordinates from IP service:",e),null;return{latitude:r,longitude:o,city:a,region:n,country:s,displayName:n?"".concat(a,", ").concat(n,", ").concat(s):"".concat(a,", ").concat(s),source:"geolocation"}}catch(e){return console.warn("Failed to parse IP location response:",e),null}}async getLocationWithFallback(e){let t={skipGeolocation:!1,skipIPFallback:!1,...e};if(!t.skipGeolocation)try{return console.log("Attempting geolocation detection..."),await this.getCurrentLocation()}catch(e){if(console.log("Geolocation failed, trying fallback:",e.message),"PERMISSION_DENIED"===e.code)throw e}if(!t.skipIPFallback)try{return console.log("Attempting IP-based location detection..."),await this.getLocationByIP()}catch(e){console.log("IP-based detection failed:",e)}throw this.createLocationError("POSITION_UNAVAILABLE","Unable to determine your location automatically","Please enter your location manually or allow location access")}clearCache(){this.currentPosition=null,this.lastRequestTime=0,console.log("Location cache cleared")}handleGeolocationError(e){switch(e.code){case e.PERMISSION_DENIED:return this.createLocationError("PERMISSION_DENIED","Location access denied","Please allow location access in your browser settings or enter your location manually");case e.POSITION_UNAVAILABLE:return this.createLocationError("POSITION_UNAVAILABLE","Location information unavailable","Please check your device location settings or enter your location manually");case e.TIMEOUT:return this.createLocationError("TIMEOUT","Location request timed out","Please try again or enter your location manually");default:return this.createLocationError("POSITION_UNAVAILABLE","Failed to get location","Please try again or enter your location manually")}}createLocationError(e,t,r){return{code:e,message:t,suggestion:r}}formatLocationDisplay(e){return e.city&&e.region&&e.country?"".concat(e.city,", ").concat(e.region,", ").concat(e.country):e.city&&e.country?"".concat(e.city,", ").concat(e.country):e.displayName?e.displayName:"".concat(e.latitude.toFixed(4),", ").concat(e.longitude.toFixed(4))}getCoordinateString(e){return"".concat(e.latitude,",").concat(e.longitude)}getCachedLocation(){return this.currentPosition&&Date.now()-this.lastRequestTime<this.CACHE_DURATION?this.currentPosition:null}constructor(){this.currentPosition=null,this.lastRequestTime=0,this.CACHE_DURATION=3e5}}let f=u.getInstance();class m{static getInstance(){return m.instance||(m.instance=new m),m.instance}initializeDefaults(){if(!this.getPreferences()){let e={settings:{units:"imperial",theme:"dark",cacheEnabled:!0},updatedAt:Date.now()};this.savePreferences(e)}}isStorageAvailable(){try{let e=this.STORAGE_PREFIX+"test";return localStorage.setItem(e,"test"),localStorage.removeItem(e),!0}catch(e){return console.warn("localStorage not available:",e),!1}}getPreferences(){if(!this.isStorageAvailable())return null;try{let e=localStorage.getItem(this.STORAGE_PREFIX+this.PREFERENCES_KEY);if(e){let t=JSON.parse(e);return this.validateAndMigratePreferences(t)}}catch(e){console.warn("Failed to get preferences:",e),this.handleCorruptedData(this.PREFERENCES_KEY)}return null}savePreferences(e){if(!this.isStorageAvailable())return!1;try{e.updatedAt=Date.now();let t=JSON.stringify(e);return localStorage.setItem(this.STORAGE_PREFIX+this.PREFERENCES_KEY,t),console.log("Preferences saved successfully"),!0}catch(e){return console.error("Failed to save preferences:",e),this.handleStorageQuotaExceeded(),!1}}updateSettings(e){let t=this.getPreferences();return!!t&&(t.settings={...t.settings,...e},this.savePreferences(t))}saveLastLocation(e){let t=this.getPreferences();return!!t&&(t.lastLocation=e,this.savePreferences(t))}getLastLocation(){let e=this.getPreferences();return(null==e?void 0:e.lastLocation)||null}cacheWeatherData(e,t,r){if(!this.isStorageAvailable())return!1;let o=this.getPreferences();if(!(null==o?void 0:o.settings.cacheEnabled))return!1;try{let o=r||this.DEFAULT_WEATHER_CACHE_DURATION,a={data:t,timestamp:Date.now(),expiresAt:Date.now()+o,locationKey:e},n=this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY+"_"+this.sanitizeKey(e);return localStorage.setItem(n,JSON.stringify(a)),console.log("Weather data cached for ".concat(e,", expires in ").concat(Math.round(o/1e3/60)," minutes")),!0}catch(e){return console.warn("Failed to cache weather data:",e),this.handleStorageQuotaExceeded(),!1}}getCachedWeatherData(e){if(!this.isStorageAvailable())return null;try{let t=this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY+"_"+this.sanitizeKey(e),r=localStorage.getItem(t);if(r){let o=JSON.parse(r);if(Date.now()<o.expiresAt)return console.log("Using cached weather data for ".concat(e)),o.data;localStorage.removeItem(t),console.log("Cached weather data expired for ".concat(e))}}catch(t){console.warn("Failed to get cached weather data:",t),this.handleCorruptedData(e)}return null}clearWeatherCache(e){if(!this.isStorageAvailable())return!1;try{if(e){let t=this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY+"_"+this.sanitizeKey(e);localStorage.removeItem(t),console.log("Weather cache cleared for ".concat(e))}else{let e=Object.keys(localStorage).filter(e=>e.startsWith(this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY));e.forEach(e=>localStorage.removeItem(e)),console.log("All weather cache cleared (".concat(e.length," entries)"))}return!0}catch(e){return console.error("Failed to clear weather cache:",e),!1}}getCacheMetrics(){let e={totalEntries:0,totalSize:0,expiredEntries:0};if(!this.isStorageAvailable())return e;try{let t=Object.keys(localStorage).filter(e=>e.startsWith(this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY)),r=Date.now(),o=0;t.forEach(t=>{try{let a=localStorage.getItem(t);if(a){e.totalSize+=2*a.length,e.totalEntries++;let t=JSON.parse(a);t.timestamp<r&&(r=t.timestamp),t.timestamp>o&&(o=t.timestamp),Date.now()>t.expiresAt&&e.expiredEntries++}}catch(r){console.warn("Corrupted cache entry: ".concat(t)),e.expiredEntries++}}),e.totalEntries>0&&(e.oldestEntry=r,e.newestEntry=o)}catch(e){console.error("Failed to get cache metrics:",e)}return e}performMaintenanceCleanup(){if(this.isStorageAvailable())try{let e=this.getCacheMetrics();console.log("Cache metrics before cleanup:",e),e.expiredEntries>0&&this.cleanupExpiredEntries(),e.totalSize>this.MAX_CACHE_SIZE&&this.cleanupOldestEntries(),console.log("Cache maintenance completed")}catch(e){console.error("Cache maintenance failed:",e)}}cleanupExpiredEntries(){let e=Object.keys(localStorage).filter(e=>e.startsWith(this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY)),t=0;e.forEach(e=>{try{let r=localStorage.getItem(e);if(r){let o=JSON.parse(r);Date.now()>o.expiresAt&&(localStorage.removeItem(e),t++)}}catch(r){localStorage.removeItem(e),t++}}),console.log("Removed ".concat(t," expired/corrupted cache entries"))}cleanupOldestEntries(){let e=Object.keys(localStorage).filter(e=>e.startsWith(this.STORAGE_PREFIX+this.WEATHER_CACHE_KEY)),t=[];e.forEach(e=>{try{let r=localStorage.getItem(e);if(r){let o=JSON.parse(r);t.push({key:e,timestamp:o.timestamp,size:2*r.length})}}catch(r){t.push({key:e,timestamp:0,size:0})}}),t.sort((e,t)=>e.timestamp-t.timestamp);let r=t.reduce((e,t)=>e+t.size,0),o=0;for(;r>this.MAX_CACHE_SIZE&&t.length>0;){let e=t.shift();localStorage.removeItem(e.key),r-=e.size,o++}console.log("Removed ".concat(o," old cache entries to reduce size"))}handleCorruptedData(e){try{let t=this.STORAGE_PREFIX+e;localStorage.removeItem(t),console.log("Removed corrupted data: ".concat(e))}catch(e){console.error("Failed to remove corrupted data:",e)}}handleStorageQuotaExceeded(){console.warn("Storage quota exceeded, performing emergency cleanup"),this.cleanupOldestEntries(),this.cleanupExpiredEntries()}validateAndMigratePreferences(e){let t={settings:{units:"imperial",theme:"dark",cacheEnabled:!0},updatedAt:Date.now()};return{...t,...e,settings:{...t.settings,...e.settings}}}sanitizeKey(e){return e.replace(/[^a-zA-Z0-9_-]/g,"_").substring(0,50)}clearAllData(){if(!this.isStorageAvailable())return!1;try{let e=Object.keys(localStorage).filter(e=>e.startsWith(this.STORAGE_PREFIX));return e.forEach(e=>localStorage.removeItem(e)),console.log("All user data cleared (".concat(e.length," entries)")),this.initializeDefaults(),!0}catch(e){return console.error("Failed to clear all data:",e),!1}}exportUserData(){try{let e=this.getPreferences(),t=this.getCacheMetrics(),r={version:"1.0",timestamp:Date.now(),preferences:e,cacheMetrics:t};return JSON.stringify(r,null,2)}catch(e){return console.error("Failed to export user data:",e),null}}importUserData(e){try{let t=JSON.parse(e);if(t.preferences){let e=this.validateAndMigratePreferences(t.preferences);return this.savePreferences(e)}return!1}catch(e){return console.error("Failed to import user data:",e),!1}}getLocationKey(e){return"".concat(e.latitude.toFixed(4),"_").concat(e.longitude.toFixed(4))}getLocationKeyFromCoords(e){let[t,r]=e.split(",").map(parseFloat);return"".concat(t.toFixed(4),"_").concat(r.toFixed(4))}constructor(){this.STORAGE_PREFIX="bitweather_",this.PREFERENCES_KEY="user_preferences",this.WEATHER_CACHE_KEY="weather_cache",this.DEFAULT_WEATHER_CACHE_DURATION=6e5,this.DEFAULT_LOCATION_CACHE_DURATION=864e5,this.MAX_CACHE_SIZE=5242880,this.initializeDefaults(),this.performMaintenanceCleanup()}}let g=m.getInstance();var x=r(8983),p=r(9159),b=r(9842),E=r(2623),v=r(9509);let w=v.env.NEXT_PUBLIC_OPENWEATHER_API_KEY||v.env.REACT_APP_OPENWEATHER_API_KEY;console.log("\uD83D\uDD0D MAIN PAGE ENVIRONMENT DEBUG:"),console.log("NODE_ENV:","production"),console.log("NEXT_PUBLIC_OPENWEATHER_API_KEY:",v.env.NEXT_PUBLIC_OPENWEATHER_API_KEY?"SET":"MISSING"),console.log("REACT_APP_OPENWEATHER_API_KEY:",v.env.REACT_APP_OPENWEATHER_API_KEY?"SET":"MISSING"),console.log("Final API_KEY:",w?"SET":"MISSING"),w?console.log("✅ OpenWeather API key found:",w.substring(0,8)+"..."):(console.error("❌ OpenWeather API key is missing!"),console.error("Please set either NEXT_PUBLIC_OPENWEATHER_API_KEY or REACT_APP_OPENWEATHER_API_KEY environment variable."),console.error("For Next.js, use NEXT_PUBLIC_OPENWEATHER_API_KEY"));let y=v.env.NEXT_PUBLIC_GOOGLE_POLLEN_API_KEY||v.env.REACT_APP_GOOGLE_POLLEN_API_KEY;function F(){var e,t,r,u,m,v;let{theme:y}=(0,i.D)(),[F,N]=(0,a.useState)(null),[A,S]=(0,a.useState)(!1),[I,P]=(0,a.useState)(""),[_,C]=(0,a.useState)(!1),[j,k]=(0,a.useState)(""),[T,R]=(0,a.useState)(""),[O,L]=(0,a.useState)(""),[D,H]=(0,a.useState)(!1),[W,G]=(0,a.useState)(10),[U,K]=(0,a.useState)(""),[M,Y]=(0,a.useState)(!1),[B,z]=(0,a.useState)("dark"),[X,q]=(0,a.useState)(new Map),[J,V]=(0,a.useState)(null),[Q,Z]=(0,a.useState)(!1),[$,ee]=(0,a.useState)(!1),et="bitweather_city",er="bitweather_weather_data",eo="bitweather_cache_timestamp",ea="weather-app-rate-limit",en="weather-search-cache";(0,a.useEffect)(()=>{Y(!0)},[]);let es=async e=>{try{console.log("Location detected:",e),g.saveLastLocation(e);let t=g.getLocationKey(e),r=g.getCachedWeatherData(t);if(r){console.log("Using cached weather data for detected location"),N(r),L(e.displayName),R(e.displayName),C(!0),P("");return}S(!0),P("");let o=g.getLocationKey(e).replace("_",","),a=await (0,c.fetchWeatherByLocation)(o);a&&(N(a),L(e.displayName),R(e.displayName),C(!0),g.cacheWeatherData(t,a),ex(e.displayName),ep(a),console.log("Weather data loaded for auto-detected location"))}catch(e){console.error("Failed to load weather for detected location:",e),P("Failed to load weather data for your location")}finally{S(!1)}};(0,a.useEffect)(()=>{if(!M||$)return;let e=setTimeout(async()=>{try{let e=g.getLastLocation();if(e){console.log("Using cached last location:",e),await es(e);return}let t=localStorage.getItem(et),r=localStorage.getItem(er),o=localStorage.getItem(eo);if(t&&r&&o&&Date.now()-parseInt(o)<6e5){console.log("Using fresh cached data, skipping auto-location");return}console.log("Attempting silent location detection..."),Z(!0);try{let e=await f.getCurrentLocation();await es(e)}catch(e){console.log("Geolocation failed, trying IP fallback:",e.message);try{let e=await f.getLocationByIP();await es(e)}catch(e){console.log("IP location also failed, using default location:",e),await eF("San Francisco, CA")}}finally{Z(!1)}ee(!0)}catch(e){console.error("Auto-location initialization failed:",e),Z(!1),ee(!0)}},1e3);return()=>clearTimeout(e)},[M,$]),(0,a.useEffect)(()=>{M&&q(eb())},[M]);let ec=()=>{if(M)try{let e=localStorage.getItem(et);e&&(L(e),R(e))}catch(e){console.warn("Failed to load cached location:",e)}},ei=()=>{M&&z(ed())},el=e=>{try{if(!e){console.warn("Attempted to set null/undefined weather data");return}N(e),P("")}catch(e){console.error("Error setting weather data:",e),P("Failed to process weather data")}};(0,a.useEffect)(()=>{M&&(ec(),ei(),(async()=>{try{let e=localStorage.getItem(et),t=localStorage.getItem(er),r=localStorage.getItem(eo);if(e&&t&&r&&Date.now()-parseInt(r)<6e5){let r=JSON.parse(t);el(r),L(e),C(!0);return}}catch(e){console.warn("Cache check failed:",e)}})())},[M]);let ed=()=>{if(!M)return"dark";try{let e=localStorage.getItem("weather-edu-theme");if(e&&["dark","miami","tron"].includes(e))return e}catch(e){console.warn("Failed to get stored theme:",e),P("Theme loading failed, using default")}return"dark"};(0,a.useEffect)(()=>{if(M)try{let e=ed();z(e);let t=()=>{try{let e=ed();z(e)}catch(e){console.error("Error handling storage change:",e)}};window.addEventListener("storage",t);let r=setInterval(()=>{try{let e=ed();e!==B&&z(e)}catch(e){console.error("Error polling theme changes:",e)}},100);return()=>{try{window.removeEventListener("storage",t),clearInterval(r)}catch(e){console.error("Error cleaning up theme listeners:",e)}}}catch(e){console.error("Error initializing theme management:",e),P("Theme initialization failed")}},[M,B]);let eh=(e=>{let t=(0,E.bJ)(e),r=(0,E.OT)(e);return{background:t.backgroundClass,cardBg:t.cardClass,borderColor:"dark"===e?"border-[#00d4ff]":"miami"===e?"border-[#ff1493]":"border-[#00FFFF]",text:"".concat(r.normal," text-[").concat("dark"===e?"#e0e0e0":"miami"===e?"#00ffff":"white","]"),headerText:"".concat(r.gradient),secondaryText:"".concat(r.normal," text-[").concat("dark"===e?"#e0e0e0":"miami"===e?"#00ffff":"white","]"),accentText:"".concat(r.gradient),successText:"text-[#00ff00]",glow:"",specialBorder:"dark"===e?"border-[#00d4ff]":"miami"===e?"border-[#ff1493]":"border-[#00FFFF]",buttonHover:"hover:bg-[".concat("dark"===e?"#00d4ff":"miami"===e?"#ff1493":"#00FFFF","] hover:text-[").concat("dark"===e?"#0f0f0f":"miami"===e?"#0a0025":"black","] smooth-transition"),gradientText:t.textClass,cardGradient:t.cardClass,backgroundGradient:t.backgroundClass}})(B),eu=()=>{if(!M)return{requests:[],lastReset:Date.now()};try{let e=localStorage.getItem(ea);if(e)return JSON.parse(e)}catch(e){console.warn("Failed to get rate limit data:",e)}return{requests:[],lastReset:Date.now()}},ef=e=>{if(M)try{if(!e||"object"!=typeof e){console.warn("Invalid rate limit data provided");return}localStorage.setItem(ea,JSON.stringify(e))}catch(e){console.warn("Failed to save rate limit data:",e),P("Rate limiting storage failed")}},em=()=>{let e=Date.now(),t=eu();e-t.lastReset>36e5&&ef(t={requests:[],lastReset:e});let r=t.requests.filter(t=>e-t<36e5),o=10-r.length;if(r.length>=10){let t=Math.ceil((36e5-(e-Math.min(...r)))/1e3/60);return{allowed:!1,remaining:0,message:"Too many requests. Please wait ".concat(t," minutes before searching again.")}}return{allowed:!0,remaining:o}},eg=()=>{let e=Date.now(),t=eu();t.requests.push(e),t.requests=t.requests.filter(t=>e-t<36e5),ef(t)};(0,a.useEffect)(()=>{if(!M)return;let{remaining:e}=em();G(e)},[M]);let ex=e=>{if(M)try{localStorage.setItem(et,e)}catch(e){console.warn("Failed to save location to cache:",e)}},ep=e=>{if(M)try{if(!e||"object"!=typeof e){console.warn("Invalid weather data provided for caching");return}localStorage.setItem(er,JSON.stringify(e)),localStorage.setItem(eo,Date.now().toString())}catch(e){console.warn("Failed to save weather data to cache:",e),P("Weather data caching failed")}},eb=()=>{if(!M)return new Map;try{let e=localStorage.getItem(en);if(e){let t=JSON.parse(e),r=new Map,o=Date.now();for(let[e,a]of Object.entries(t))"object"==typeof a&&null!==a&&"data"in a&&"timestamp"in a&&o-a.timestamp<3e5&&r.set(e,a);return r}}catch(e){console.warn("Failed to get search cache:",e)}return new Map},eE=e=>{if(M)try{let t=Object.fromEntries(e);localStorage.setItem(en,JSON.stringify(t))}catch(e){console.warn("Failed to save search cache:",e)}},ev=(e,t)=>{let r=eb();r.set(e.toLowerCase().trim(),{data:t,timestamp:Date.now()}),eE(r),q(r)},ew=e=>{let t=eb().get(e.toLowerCase().trim());return t&&Date.now()-t.timestamp<3e5?t.data:null},ey=e=>{console.error("Weather data error:",e),P(e.message||"Failed to load weather data"),N(null)},eF=async function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(console.log("Starting search for:",e),!e.trim()){P("Please enter a location");return}if(e.trim().length<3){P("Please enter at least 3 characters");return}if(!t){let e=em();if(!e.allowed){K(e.message||"Rate limit exceeded");return}}S(!0),P(""),K("");try{console.log("Fetching weather data...");let t=ew(e);if(t){console.log("Weather data found in cache"),N(t),C(!0),k(e),R(e);return}if(!w)throw Error("OpenWeather API key is not configured");let r=await (0,c.v)(e,w);if(console.log("Weather data received:",r),!r)throw Error("No weather data received");if(!r.temperature||!r.condition)throw Error("Invalid weather data received");N(r),C(!0),k(e),R(e),ex(e),ep(r),eg(),ev(e,r),console.log("Search completed successfully")}catch(e){console.error("Search error:",e),ey(e)}finally{S(!1)}},eN=async()=>{if(!f.isGeolocationSupported()){P("Geolocation is not supported by your browser");return}S(!0),P("");try{let e=await f.getCurrentLocation();await es(e),eg()}catch(e){console.error("Location error:",e),P(e.message||"Failed to get your location")}finally{S(!1)}};return(0,o.jsxs)(l.A,{weatherLocation:null==F?void 0:F.location,weatherTemperature:null==F?void 0:F.temperature,weatherUnit:null==F?void 0:F.unit,children:[(0,o.jsx)("div",{className:(0,s.cn)("min-h-screen","dark"===y&&"bg-gradient-to-b from-gray-900 to-black","miami"===y&&"bg-gradient-to-b from-pink-900 to-purple-900","tron"===y&&"bg-gradient-to-b from-black to-blue-900"),children:(0,o.jsxs)(p.u,{maxWidth:"xl",padding:"md",children:[(0,o.jsx)(b.tH,{componentName:"Weather Search",theme:B,children:(0,o.jsx)(h.A,{onSearch:eF,onLocationSearch:eN,isLoading:A||Q,error:I,rateLimitError:U,isDisabled:D,theme:y,hideLocationButton:!0})}),!F&&!A&&!I&&(0,o.jsx)("div",{className:"text-center mt-8 mb-8 px-2 sm:px-0",children:(0,o.jsx)("div",{className:"w-full max-w-xl mx-auto",children:(0,o.jsx)("div",{className:(0,s.cn)("p-2 sm:p-3 border-2 shadow-lg","dark"===y&&"bg-[#0f0f0f] border-[#00d4ff] shadow-blue-500/20","miami"===y&&"bg-[#0a0025] border-[#ff1493] shadow-pink-500/30","tron"===y&&"bg-black border-[#00FFFF] shadow-cyan-500/40"),children:(0,o.jsx)("p",{className:"text-sm font-mono font-bold uppercase tracking-wider text-white",style:{fontFamily:"monospace",fontSize:"clamp(10px, 2.4vw, 14px)"},children:"► PRESS START TO INITIALIZE WEATHER DATA ◄"})})})}),(A||Q)&&(0,o.jsxs)("div",{className:"flex justify-center items-center mt-8",children:[(0,o.jsx)(n.A,{className:(0,s.cn)("h-8 w-8 animate-spin","dark"===y&&"text-blue-500","miami"===y&&"text-pink-500","tron"===y&&"text-cyan-500")}),(0,o.jsx)("span",{className:"ml-2 text-white",children:Q?"Detecting your location...":"Loading weather data..."})]}),I&&(0,o.jsx)("div",{className:"text-red-500 text-center mt-4",children:I}),U&&(0,o.jsx)("div",{className:"text-yellow-500 text-center mt-4",children:U}),F&&!A&&!I&&(0,o.jsx)(b.tH,{componentName:"Weather Display",theme:B,children:(0,o.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,o.jsxs)(p.N,{cols:{sm:1,md:3},className:"gap-4",children:[(0,o.jsxs)("div",{className:"p-4 rounded-lg text-center border-2 shadow-lg ".concat(eh.cardBg," ").concat(eh.borderColor),style:{boxShadow:"0 0 15px ".concat(eh.borderColor.replace("border-[","").replace("]",""),"33")},children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(eh.headerText),children:"Temperature"}),(0,o.jsxs)("p",{className:"text-3xl font-bold ".concat(eh.text),children:[(null==F?void 0:F.temperature)||"N/A",(null==F?void 0:F.unit)||"\xb0F"]})]}),(0,o.jsxs)("div",{className:"p-4 rounded-lg text-center border-2 shadow-lg ".concat(eh.cardBg," ").concat(eh.borderColor),style:{boxShadow:"0 0 15px ".concat(eh.borderColor.replace("border-[","").replace("]",""),"33")},children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(eh.headerText),children:"Conditions"}),(0,o.jsx)("p",{className:"text-lg ".concat(eh.text),children:(null==F?void 0:F.condition)||"Unknown"}),(0,o.jsx)("p",{className:"text-sm ".concat(eh.secondaryText),children:(null==F?void 0:F.description)||"No description available"})]}),(0,o.jsxs)("div",{className:"p-4 rounded-lg text-center border-2 shadow-lg ".concat(eh.cardBg," ").concat(eh.borderColor),style:{boxShadow:"0 0 15px ".concat(eh.borderColor.replace("border-[","").replace("]",""),"33")},children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(eh.headerText),children:"Wind"}),(0,o.jsxs)("p",{className:"text-lg ".concat(eh.text),children:[(null==F?void 0:null===(e=F.wind)||void 0===e?void 0:e.direction)?"".concat(F.wind.direction," "):"",(null==F?void 0:null===(t=F.wind)||void 0===t?void 0:t.speed)||"N/A"," mph",(null==F?void 0:null===(r=F.wind)||void 0===r?void 0:r.gust)?" (gusts ".concat(F.wind.gust," mph)"):""]})]})]}),(0,o.jsxs)(p.N,{cols:{sm:1,md:3},className:"gap-4",children:[(0,o.jsxs)("div",{className:"p-4 rounded-lg text-center border-2 shadow-lg ".concat(eh.cardBg," ").concat(eh.borderColor),style:{boxShadow:"0 0 15px ".concat(eh.borderColor.replace("border-[","").replace("]",""),"33")},children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(eh.headerText),children:"Sun Times"}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,o.jsx)("span",{className:"text-yellow-400",children:"☀️"}),(0,o.jsxs)("p",{className:eh.text,children:["Sunrise: ",(null==F?void 0:F.sunrise)||"N/A"]})]}),(0,o.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,o.jsx)("span",{className:"text-orange-400",children:"\uD83C\uDF05"}),(0,o.jsxs)("p",{className:eh.text,children:["Sunset: ",(null==F?void 0:F.sunset)||"N/A"]})]})]})]}),(0,o.jsxs)("div",{className:"p-4 rounded-lg text-center border-2 shadow-lg ".concat(eh.cardBg," ").concat(eh.borderColor),style:{boxShadow:"0 0 15px ".concat(eh.borderColor.replace("border-[","").replace("]",""),"33")},children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(eh.headerText),children:"UV Index"}),(0,o.jsx)("p",{className:"text-lg font-bold ".concat(eh.text),children:(null==F?void 0:F.uvIndex)||"N/A"})]}),(0,o.jsxs)("div",{className:"p-4 rounded-lg text-center border-2 shadow-lg ".concat(eh.cardBg," ").concat(eh.borderColor),style:{boxShadow:"0 0 15px ".concat(eh.borderColor.replace("border-[","").replace("]",""),"33")},children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(eh.headerText),children:"Moon Phase"}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,o.jsx)("span",{className:"text-2xl",children:(e=>{let t=e.toLowerCase();return t.includes("new")?"●":t.includes("waxing crescent")?"\uD83C\uDF12":t.includes("first quarter")?"\uD83C\uDF13":t.includes("waxing gibbous")?"\uD83C\uDF14":t.includes("full")?"\uD83C\uDF15":t.includes("waning gibbous")?"\uD83C\uDF16":t.includes("last quarter")?"\uD83C\uDF17":t.includes("waning crescent")?"\uD83C\uDF18":"\uD83C\uDF11"})((null==F?void 0:null===(u=F.moonPhase)||void 0===u?void 0:u.phase)||"new")}),(0,o.jsx)("p",{className:"text-lg font-semibold ".concat(eh.text),children:(null==F?void 0:null===(m=F.moonPhase)||void 0===m?void 0:m.phase)||"Unknown"})]}),(0,o.jsxs)("p",{className:"text-sm font-medium ".concat(eh.secondaryText),children:[(null==F?void 0:null===(v=F.moonPhase)||void 0===v?void 0:v.illumination)||0,"% illuminated"]})]})]})]}),(0,o.jsx)(x.fF,{weather:F,theme:y}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.wQ,{forecast:((null==F?void 0:F.forecast)||[]).map((e,t)=>({...e,country:(null==F?void 0:F.country)||"US"})),theme:y,onDayClick:e=>{V(J===e?null:e)},selectedDay:J}),(0,o.jsx)(x.st,{forecast:((null==F?void 0:F.forecast)||[]).map((e,t)=>({...e,country:(null==F?void 0:F.country)||"US"})),theme:y,selectedDay:J,currentWeatherData:{humidity:(null==F?void 0:F.humidity)||0,wind:(null==F?void 0:F.wind)||{speed:0,direction:"",gust:null},pressure:(null==F?void 0:F.pressure)||1013,uvIndex:(null==F?void 0:F.uvIndex)||0,sunrise:(null==F?void 0:F.sunrise)||"N/A",sunset:(null==F?void 0:F.sunset)||"N/A"}})]})]})}),(0,o.jsxs)("div",{className:(0,s.cn)("mt-16 pt-8 border-t-2 text-center","dark"===y&&"border-[#00d4ff]","miami"===y&&"border-[#ff1493]","tron"===y&&"border-[#00FFFF]"),children:[(0,o.jsx)("h2",{className:(0,s.cn)("text-lg font-bold mb-4 uppercase tracking-wider font-mono","dark"===y&&"text-[#00d4ff]","miami"===y&&"text-[#ff1493]","tron"===y&&"text-[#00FFFF]"),children:"WEATHER BY CITY"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3 max-w-4xl mx-auto",children:[(0,o.jsx)("a",{href:"/weather/new-york-ny",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"NEW YORK"}),(0,o.jsx)("a",{href:"/weather/los-angeles-ca",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"LOS ANGELES"}),(0,o.jsx)("a",{href:"/weather/chicago-il",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"CHICAGO"}),(0,o.jsx)("a",{href:"/weather/houston-tx",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"HOUSTON"}),(0,o.jsx)("a",{href:"/weather/phoenix-az",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"PHOENIX"}),(0,o.jsx)("a",{href:"/weather/philadelphia-pa",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"PHILADELPHIA"}),(0,o.jsx)("a",{href:"/weather/san-antonio-tx",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"SAN ANTONIO"}),(0,o.jsx)("a",{href:"/weather/san-diego-ca",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"SAN DIEGO"}),(0,o.jsx)("a",{href:"/weather/dallas-tx",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"DALLAS"}),(0,o.jsx)("a",{href:"/weather/austin-tx",className:(0,s.cn)("block px-3 py-2 text-sm font-mono rounded border transition-colors","dark"===y&&"border-[#00d4ff] text-[#e0e0e0] hover:bg-[#00d4ff] hover:text-[#0f0f0f]","miami"===y&&"border-[#ff1493] text-[#00ffff] hover:bg-[#ff1493] hover:text-[#0a0025]","tron"===y&&"border-[#00FFFF] text-white hover:bg-[#00FFFF] hover:text-black"),children:"AUSTIN"})]})]})]})}),(0,o.jsx)(d.Analytics,{})]})}function N(){return(0,o.jsx)(F,{})}y?console.log("✅ Google Pollen API key found:",y.substring(0,8)+"..."):(console.warn("⚠️ Google Pollen API key is missing!"),console.warn("Please set either NEXT_PUBLIC_GOOGLE_POLLEN_API_KEY or REACT_APP_GOOGLE_POLLEN_API_KEY environment variable for real pollen data."))},7016:(e,t,r)=>{Promise.resolve().then(r.bind(r,5678))},8983:(e,t,r)=>{"use strict";r.d(t,{fF:()=>m,st:()=>f,wQ:()=>u});var o=r(5155),a=r(2115),n=r(1154),s=r(3999),c=r(9842);let i=(0,a.lazy)(()=>r.e(208).then(r.bind(r,5208))),l=(0,a.lazy)(()=>r.e(722).then(r.bind(r,3722))),d=(0,a.lazy)(()=>r.e(243).then(r.bind(r,4243)));function h(e){let{theme:t}=e;return(0,o.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,o.jsx)(n.A,{className:(0,s.cn)("h-8 w-8 animate-spin","dark"===t&&"text-blue-500","miami"===t&&"text-pink-500","tron"===t&&"text-cyan-500")}),(0,o.jsx)("span",{className:"ml-2 text-white text-sm",children:"Loading weather data..."})]})}function u(e){return(0,o.jsx)(c.tH,{componentName:"Weather Forecast",theme:e.theme,children:(0,o.jsx)(a.Suspense,{fallback:(0,o.jsx)(h,{theme:e.theme}),children:(0,o.jsx)(i,{...e})})})}function f(e){return(0,o.jsx)(c.tH,{componentName:"Forecast Details",theme:e.theme,children:(0,o.jsx)(a.Suspense,{fallback:(0,o.jsx)(h,{theme:e.theme}),children:(0,o.jsx)(l,{...e})})})}function m(e){return(0,o.jsx)(c.tH,{componentName:"Environmental Display",theme:e.theme,children:(0,o.jsx)(a.Suspense,{fallback:(0,o.jsx)(h,{theme:e.theme}),children:(0,o.jsx)(d,{...e})})})}},9159:(e,t,r)=>{"use strict";r.d(t,{N:()=>s,u:()=>n});var o=r(5155),a=r(3999);function n(e){let{children:t,className:r,maxWidth:n="full",padding:s="md"}=e;return(0,o.jsx)("div",{className:(0,a.cn)("container mx-auto w-full",{sm:"max-w-sm",md:"max-w-md",lg:"max-w-2xl",xl:"max-w-4xl","2xl":"max-w-6xl",full:"max-w-full"}[n],{none:"",sm:"px-2 py-2",md:"px-4 py-4",lg:"px-6 py-6"}[s],"min-h-0",r),children:t})}function s(e){let{children:t,className:r,cols:n={sm:1,md:2,lg:3}}=e,s=(0,a.cn)("grid gap-4 w-full","grid-cols-".concat(n.sm||1),n.md&&"md:grid-cols-".concat(n.md),n.lg&&"lg:grid-cols-".concat(n.lg),r);return(0,o.jsx)("div",{className:s,children:t})}},9842:(e,t,r)=>{"use strict";r.d(t,{tH:()=>i});var o=r(5155),a=r(2115),n=r(1243),s=r(3904),c=r(3999);class i extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}getThemeClasses(){let{theme:e="dark"}=this.props;switch(e){case"miami":return{container:"bg-[#0a0025] border-[#ff1493] text-[#00ffff]",button:"bg-[#ff1493] text-[#0a0025] hover:bg-[#ff69b4]",icon:"text-[#ff1493]",text:"text-[#00ffff]"};case"tron":return{container:"bg-black border-[#00FFFF] text-white",button:"bg-[#00FFFF] text-black hover:bg-[#00DCFF]",icon:"text-[#00FFFF]",text:"text-white"};default:return{container:"bg-[#0f0f0f] border-[#00d4ff] text-[#e0e0e0]",button:"bg-[#00d4ff] text-[#0f0f0f] hover:bg-[#00b8e6]",icon:"text-[#00d4ff]",text:"text-[#e0e0e0]"}}}render(){let{hasError:e,error:t}=this.state,{children:r,fallback:a,componentName:i,className:l}=this.props,d=this.getThemeClasses();return e?a||(0,o.jsxs)("div",{className:(0,c.cn)("flex flex-col items-center justify-center p-6 border-2 rounded-lg","min-h-[200px] max-w-lg mx-auto font-mono",d.container,l),children:[(0,o.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,o.jsx)(n.A,{className:(0,c.cn)("w-6 h-6",d.icon)}),(0,o.jsx)("h2",{className:"text-lg font-bold uppercase tracking-wider",children:"Component Error"})]}),(0,o.jsxs)("div",{className:"text-center mb-6",children:[(0,o.jsx)("p",{className:(0,c.cn)("text-sm mb-2",d.text),children:i?"Error in ".concat(i):"Something went wrong"}),t&&(0,o.jsxs)("details",{className:"mt-3",children:[(0,o.jsx)("summary",{className:"cursor-pointer text-xs opacity-70 hover:opacity-100",children:"Show Error Details"}),(0,o.jsx)("pre",{className:"text-xs mt-2 p-2 bg-black/20 rounded overflow-auto max-h-32",children:t.message})]})]}),(0,o.jsxs)("button",{onClick:this.handleRetry,className:(0,c.cn)("flex items-center gap-2 px-4 py-2 rounded font-medium","transition-colors duration-200 text-sm uppercase tracking-wider",d.button),children:[(0,o.jsx)(s.A,{className:"w-4 h-4"}),"Retry"]})]}):r}constructor(...e){super(...e),this.state={hasError:!1},this.handleRetry=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})}}}}},e=>{var t=t=>e(e.s=t);e.O(0,[477,717,236,603,441,684,358],()=>t(7016)),_N_E=e.O()}]);